steps:

- template: install.yml

- bash: |
    export MAMBA_EXE="/home/vsts/work/1/s/micromamba"
    export MAMBA_ROOT_PREFIX="/home/vsts/micromamba"
    source /home/vsts/micromamba/etc/profile.d/mamba.sh
    micromamba activate wradlib-tests
    pytest --verbose --tb=long --doctest-modules --durations=15 --cov-report xml:coverage.xml --cov=wradlib --pyargs notebooks
  displayName: Run tests

- bash: |
    bash <(curl -s https://codecov.io/bash)
  displayName: Upload coverage to codecov.io
